Object.defineProperty(exports,"__esModule",{value:true});exports.swipeDirections=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _jsxFileName='src/index.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var React=_interopRequireWildcard(_react);var _reactNative=require('react-native');function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var swipeDirections=exports.swipeDirections={SWIPE_UP:'SWIPE_UP',SWIPE_DOWN:'SWIPE_DOWN',SWIPE_LEFT:'SWIPE_LEFT',SWIPE_RIGHT:'SWIPE_RIGHT',SWIPE_UP_LEFT:'SWIPE_UP_LEFT',SWIPE_UP_RIGHT:'SWIPE_UP_RIGHT',SWIPE_DOWN_LEFT:'SWIPE_DOWN_LEFT',SWIPE_DOWN_RIGHT:'SWIPE_DOWN_RIGHT'};function isValidSwipe(velocity,velocityThreshold,distance,distanceThreshold){return Math.abs(velocity)>velocityThreshold&&Math.abs(distance)>distanceThreshold;}function getAngle(x,y){return Math.atan(-y/x)*180/Math.PI;}function getMaxVelocity(x,y){return Math.max(Math.abs(x),Math.abs(y));}function getDistance(x,y){return Math.sqrt(Math.pow(x,2)+Math.pow(y,2));}var GestureRecognizer=function(_React$Component){_inherits(GestureRecognizer,_React$Component);function GestureRecognizer(){_classCallCheck(this,GestureRecognizer);return _possibleConstructorReturn(this,(GestureRecognizer.__proto__||Object.getPrototypeOf(GestureRecognizer)).apply(this,arguments));}_createClass(GestureRecognizer,[{key:'componentWillMount',value:function componentWillMount(){var responderEnd=this._handlePanResponderEnd.bind(this);var shouldSetResponder=this._handleShouldSetPanResponder.bind(this);this._panResponder=_reactNative.PanResponder.create({onStartShouldSetPanResponder:shouldSetResponder,onMoveShouldSetPanResponder:shouldSetResponder,onPanResponderRelease:responderEnd,onPanResponderTerminate:responderEnd});}},{key:'_handleShouldSetPanResponder',value:function _handleShouldSetPanResponder(evt,gestureState){return evt.nativeEvent.touches.length===1&&!this._gestureIsClick(gestureState);}},{key:'_gestureIsClick',value:function _gestureIsClick(gestureState){return Math.abs(gestureState.dx)<5&&Math.abs(gestureState.dy)<5;}},{key:'_handlePanResponderEnd',value:function _handlePanResponderEnd(evt,gestureState){var swipeDirection=this._getSwipeDirection(gestureState);this._triggerSwipeHandlers(swipeDirection||'',gestureState);}},{key:'_triggerSwipeHandlers',value:function _triggerSwipeHandlers(swipeDirection,gestureState){var onSwipe=this.props.onSwipe;onSwipe&&onSwipe(swipeDirection,gestureState);}},{key:'_getSwipeDirection',value:function _getSwipeDirection(gestureState){var SWIPE_LEFT=swipeDirections.SWIPE_LEFT,SWIPE_RIGHT=swipeDirections.SWIPE_RIGHT,SWIPE_UP=swipeDirections.SWIPE_UP,SWIPE_DOWN=swipeDirections.SWIPE_DOWN,SWIPE_UP_LEFT=swipeDirections.SWIPE_UP_LEFT,SWIPE_UP_RIGHT=swipeDirections.SWIPE_UP_RIGHT,SWIPE_DOWN_LEFT=swipeDirections.SWIPE_DOWN_LEFT,SWIPE_DOWN_RIGHT=swipeDirections.SWIPE_DOWN_RIGHT;var dx=gestureState.dx,dy=gestureState.dy,vx=gestureState.vx,vy=gestureState.vy;var _props=this.props,velocityThreshold=_props.velocityThreshold,distanceThreshold=_props.distanceThreshold,angleThreshold=_props.angleThreshold,diagonalSwipe=_props.diagonalSwipe;var distance=getDistance(dx,dy);if(!isValidSwipe(getMaxVelocity(vx,vy),velocityThreshold,distance,distanceThreshold)){return null;}var angle=getAngle(dx,dy);var angleAbs=Math.abs(angle);if(angleAbs<angleThreshold){return dx>0?SWIPE_RIGHT:SWIPE_LEFT;}else if(angleAbs>90-angleThreshold){return dy>0?SWIPE_DOWN:SWIPE_UP;}else if(diagonalSwipe){return dx>0?dy>0?SWIPE_DOWN_RIGHT:SWIPE_UP_RIGHT:dy>0?SWIPE_DOWN_LEFT:SWIPE_UP_LEFT;}return null;}},{key:'render',value:function render(){return React.createElement(_reactNative.View,_extends({},this.props,this._panResponder.panHandlers,{__source:{fileName:_jsxFileName,lineNumber:151}}));}}]);return GestureRecognizer;}(React.Component);GestureRecognizer.defaultProps={velocityThreshold:0.3,distanceThreshold:40,angleThreshold:15,diagonalSwipe:true};exports.default=GestureRecognizer;